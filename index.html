<!DOCTYPE html>

<html>
	<head>
		<title>Page</title>
		
		<style>
			#canvas {
				outline: 1px dotted black;
			}
			
			#debug {
				background-color: grey;
				color: red;
			}
			
			#stuff {
				display: inline-block;
			}
		</style>
	</head>
	
	<body>
		<div id="stuff">
			<canvas id="canvas" width="256" height="128"></canvas>
			<p id="debug"></p>
		</div>
		
		<script>
			let canvas = document.getElementById("canvas");
			
			let WIDTH  = canvas.getAttribute("width");
			let HEIGHT = canvas.getAttribute("height");
			
			let ctx = canvas.getContext("2d");
			
			let debugEl = document.getElementById("debug");
			function debug(txt) {
				debugEl.innerText = txt;
			}
			
			// triangle wave function, outputs 0 to 1
			let tWave=x=>Math.abs(Math.abs(x) % 2 - 1);
			
			let pos = [Math.random(), Math.random()];
			let theta = Math.random() * Math.PI * 2;
			let vel = [Math.cos(theta), Math.sin(theta)];
			
			ctx.textBaseline = "top";
			ctx.font = "2em Arial";
			let txt = "Hello";
			let txm = ctx.measureText(txt);
			let txtWidth = txm.width;
			let txtHeight = txm.fontBoundingBoxDescent;
			
			let prevTime = 0.0;
			let t = 0.0;
			
			const FPS = 60;

			function animation() {
				
				ctx.clearRect(0, 0, WIDTH, HEIGHT);

				let deltaTime = t - prevTime;

				let x = tWave(pos[0] + t * deltaTime * vel[0] * 75) * (WIDTH - txtWidth);
				let y = tWave(pos[1] + t * deltaTime * vel[1] * 75) * (HEIGHT - txtHeight);

				ctx.fillText(txt, x, y);
				
				prevTime = t;
				t += 1/60;
			}
			
			setInterval(animation, 1000/FPS);
			
		</script>
	</body>
</html>
